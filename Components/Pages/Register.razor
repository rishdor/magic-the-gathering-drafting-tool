@page "/register"
@using magick.Models
@using magick.Services
@inject Service service

<h3>Register</h3>

<EditForm Model="user" OnSubmit="HandleValidSubmit" FormName="RegistationForm">

    <div class="form-group">
        <label for="username">Username:</label>
        <InputText id="username" class="form-control" @bind-Value="user.Username" />
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        <InputText id="email" class="form-control" @bind-Value="user.Email" />
    </div>

    <div class="form-group">
        <label for="password">Password:</label>
        <InputText id="password" type='password' class="form-control" @bind-Value="user.Password" autocomplete="off" />
    </div>

    <button type="submit" class="btn btn-primary">Register</button>
</EditForm>

@code {
    [SupplyParameterFromForm]
    public User? user { get; set; }

    protected override void OnInitialized() => user ??= new();

    private async Task HandleValidSubmit()
    {
        var result = await service.RegisterUser(user);
        if (result)
        {
            Console.WriteLine("Registration successful");
        }
        else
        {
            Console.WriteLine("Registration failed");
        }
        user = new User();
    }
}